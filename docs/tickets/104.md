## ASTR-104: Workers Operations Page & Dashboard Integration

### Overview
Create a dedicated Workers operations page and integrate it with the main dashboard. Provide operational controls and richer visibility for Dramatiq workers and queues. The existing Workers card remains a summary that links to the new page.

### Project
- Project: ASTRID-API
- Priority: P3 (Medium)
- Labels: ui, frontend, workflow, ops
- Dependencies: ASTR-92 (workers), ASTR-84 (API)

### Goals
- Provide operators a fast way to start/stop/scale workers and clear queues.
- Surface actionable metrics: depth, rates, error rates, trends.
- Offer a drill‑down page for detailed per‑worker/queue inspection.

### Scope & Tasks
1. Quick Actions (card and page)
   - Buttons for Start, Stop, Scale per `WorkerType`.
   - Confirmations, optimistic UI, success/error toasts.
   - Endpoints: `POST /workers/{worker_type}/start|stop|scale`.

2. Queue Operations
   - Table of queues with depth, processing rate, error rate.
   - Clear queue action per row.
   - Endpoint: `POST /workers/queues/{queue_name}/clear`.

3. Trends & Polling Controls
   - Mini sparklines for processed tasks and failure rate (`1h`, `6h`, `24h`).
   - Poll interval selector (5s/10s/30s) and pause/resume toggle.
   - Use `GET /workers/metrics?time_window_hours={1|6|24}`.

4. Dedicated Workers Page
   - Route: `/dashboard/workers`.
   - Lists workers with `worker_id`, `worker_type`, `status`, `last_heartbeat`.
   - Lists queues with advanced metrics and actions.
   - Links back to workflows for pipeline context.

5. Health & Degraded States
   - Global banner if `health.status != healthy` or `broker_connected=false`.
   - Display uptime and last updated timestamp.
   - Endpoint: `GET /workers/health`.

### Acceptance Criteria
- Workers card shows health status, counts, throughput, avg time, queue count, plus quick actions.
- Starting/stopping/scaling a worker type updates UI within one poll cycle and shows a toast.
- Clearing a queue updates the queue table and shows a toast.
- Trends render from live data; switching time windows updates charts.
- Dedicated page available at `/dashboard/workers` with detailed lists and working actions.
- Error states are handled gracefully (timeouts, network/CORS), with visible feedback.

### API Integration Notes
- Reads: `/workers/health`, `/workers/metrics`, `/workers/queues`.
- Writes: `/workers/{worker_type}/start`, `/workers/{worker_type}/stop`, `/workers/{worker_type}/scale`, `/workers/queues/{queue_name}/clear`.
- Ensure CORS allows `http://127.0.0.1:3010` and `http://localhost:3010` in dev.

### Implementation Notes
- Use environment `NEXT_PUBLIC_API_BASE_URL` for API base.
- Use `Promise.allSettled` with per‑endpoint timeouts for resilience.
- Add lightweight sparkline component (CSS or small lib), avoiding heavy chart libs.
- Centralize toasts and confirmations.

### Out of Scope
- Historical persistence beyond the polling buffer.
- Role‑based access control for actions (future: tie to auth roles).

### Definition of Done
- Code merged; UI visible in dashboard and `/dashboard/workers`.
- Manual tests for all actions pass against local API.
- Basic docs added to `frontend/README.md` on configuration and usage.

